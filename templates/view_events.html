{% extends 'base.html' %}
{% block body %}

{% block title %}View/Addthe details of Event{% endblock %}


<div class="modal hide" id="upcomingevents" role="dialog">
  <div class="modal-dialog modal-lg" role="document">
  <div class="modal-content">    
      <div class="modal-header">
              <h3 class="modal-title">Upcoming Events</h3>
              <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">Ã—</span>
              </button>
  </div>
  <div class="modal-body">
  
  
  </div>
  <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
  </div>
</div>
</div>
</div>

<ul>
  <li><a href = "/birthday">View all birthdays</a></li>
    
</ul>

<ul>
  <li><a href = "/demise">View all Remembrance days</a></li>
    
</ul>

<ul>
  <li><a href = "/wedding">View all wedding Anniversaries</a></li>
    
</ul>

<ul>
  <li><a href = "/vacation">View all vacations list</a></li>
    
</ul>

<ul>
  <li><a href = "/festivals">View all festivals or Important days </a></li>
    
</ul>


<ul>
  <li><a href = "/addbirthday">Add birthdays</a></li>
    
</ul>

<ul>
  <li><a href = "/adddemise">Add death details </a></li>
    
</ul>

<ul>
  <li><a href = "/addwedding">Add wedding details</a></li>
    
</ul>

<ul>
  <li><a href = "/addvacation">Add vacation details</a></li>
    
</ul>

<ul>
  <li><a href = "/addfestivals">Add festive details</a></li>
    
</ul>

<button name="bdaybutton" value="OK" type="button" onclick="clickfunbday()">check upcoming birthdays</button> 
 
<button name="ddaybutton" value="OK" type="button" onclick="clickfundday()">check upcoming remembrance days</button> 

<button name="vdaybutton" value="OK" type="button" onclick="clickfunvday()">check upcoming Vacations</button> 

<button name="fdaybutton" value="OK" type="button" onclick="clickfunfday()">check upcoming Festivals</button> 

<button name="wdaybutton" value="OK" type="button" onclick="clickfunwday()">check upcoming weddings</button> 

 <!-- <table>
  <caption>Upcoming Events Table</caption>
  <thead>
    <tr>
      <th>Name</th>
      <th>Date</th>
    </tr>
  </thead>
  <tbody id="tBody"></tbody>
</table>  -->


<script>  
function sendmail(type,email) 
 {
    // var $row = $(this).closest("tr");    // Find the row
    // var $text = $row.find(".rec_email").text(); // Find the text
    
    // Let's test it out
    // alert($text);
    console.log(type,email);
    $.ajax({
      url: 'sendmail',
      type: 'POST',
      data:JSON.stringify({'recipient':email,"type":type}), 
      contentType: 'application/json;charset=UTF-8',
      success:function (response){

      }
    })
};
function clickfunbday() {
    $.ajax({
      url: 'upcomingbday',
      type: 'GET',
       headers:  { 
        "contentType": 'application/json',
        },
      success: function (response) {
        data = response
        var datalength = 1;
        var html="";
        html += '<table class="table table-bordered" >';
            html+= `<tr><th>Name</th><th>Birth Date</th><th>E-mail</th><th>Action</th></tr>`
        for(var count=0; count < response.length; count++){
            html += '<tr>';
            html += '<td>'+(data[count]["name"])+'</td>'; 
            html += '<td>'+(data[count]["birth_date"])+'</td>'; 
            html += '<td class="rec_email">'+(data[count]["email"])+'</td>'; 
            // html += '<td>'+(data[count]["phone_number"])+'</td>'; 
            html += `<td><button type="button" class="use-address" onclick = sendmail('birthday',`+"'"+data[count]["email"]+"'"+")>send Email </td>";
            html += '</tr>';
        }
        html += '</table>';      
        
        $('.modal-content .modal-body').empty().append(html) 
       
        $('#upcomingevents').modal('show'); 
                      
        },
    })
  }
</script>  

<script>  
  function clickfundday() {
      $.ajax({
        url: 'upcomingdday',
        type: 'GET',
         headers:  { 
          "contentType": 'application/json',
          },
        success: function (response) {
          data = response
        var datalength = 1;
        var html="";
        html += '<table class="table table-bordered" >';
            html+= `<tr><th>Name</th><th>Date</th></tr>`
        for(var count=0; count < response.length; count++){
            html += '<tr>';
            html += '<td>'+data[count]["name"]+'</td>'; 
            html += '<td>'+data[count]["demise_date"]+'</td>';
            // html += '<td>'+Object.values(data[count])[1]+'</td>'; 

            html += '</tr>';
        }
        html += '</table>';      
        
        $('.modal-content .modal-body').empty().append(html) 
       
        $('#upcomingevents').modal('show'); 
                        
          },
      })
    }
  </script> 


<script>  
  function clickfunvday() {
      $.ajax({
        url: 'upcomingvday',
        type: 'GET',
         headers:  { 
          "contentType": 'application/json',
          },
        success: function (response) {
          console.log(response)
          data = response
        var datalength = 1;
        var html="";
        html += '<table class="table table-bordered" >';
            html+= `<tr><th>Name</th><th>Date</th></tr>`
        for(var count=0; count < response.length; count++){
            html += '<tr>';
            html += '<td>'+data[count]["location_name"]+'</td>'; 
            html += '<td>'+data[count]["vac_start_date"]+'</td>';

            html += '</tr>';
        }
        html += '</table>';      
        
        $('.modal-content .modal-body').empty().append(html) 
       
        $('#upcomingevents').modal('show'); 
                        
          },
      })
    }
  </script> 


<script>  
  function clickfunfday() {
      $.ajax({
        url: 'upcomingfday',
        type: 'GET',
         headers:  { 
          "contentType": 'application/json',
          },
        success: function (response) {
          data = response
        var datalength = 1;
        var html="";
        html += '<table class="table table-bordered" >';
            html+= `<tr><th>Name</th><th>Date</th></tr>`
        for(var count=0; count < response.length; count++){
            html += '<tr>';
            html += '<td>'+data[count]["festive_name"]+'</td>'; 
            html += '<td>'+data[count]["festive_date"]+'</td>'; 

            html += '</tr>';
        }
        html += '</table>';      
        
        $('.modal-content .modal-body').empty().append(html) 
       
        $('#upcomingevents').modal('show'); 
                        
                        
          },
      })
    }
  </script> 


<script>  
  function clickfunwday() {
      $.ajax({
        url: 'upcomingwday',
        type: 'GET',
         headers:  { 
          "contentType": 'application/json',
          },
        success: function (response) {
          data = response
        var datalength = 1;
        var html="";
        html += '<table class="table table-bordered" >';
            html+= `<tr><th>Mr.Name</th><th>Mrs.Name</th><th>Date</th><th>Mr.Email</th><th>Mrs.Email</th></tr>`
        for(var count=0; count < response.length; count++){
          console.log(data[count]);
            html += '<tr>';
            html += '<td>'+data[count]["mr_name"]+'</td>'; 
            html += '<td>'+data[count]["mrs_name"]+'</td>'; 
            html += '<td>'+data[count]["wedding_date"]+'</td>';
            html += '<td class="rec_email">'+(data[count]["mr_email"])+'</td>'; 
            html += '<td class="rec_email">'+(data[count]["mrs_email"])+'</td>';
            html += `<td><button type="button" class="use-address" onclick = sendmail('wedding',`+"'"+data[count]["mr_email"]+"'"+")>send Email to MR </td>";
            html += `<td><button type="button" class="use-address" onclick = sendmail('wedding',`+"'"+data[count]["mrs_email"]+"'"+")>send Email to Mrs </td>";
            html += '</tr>';
          

            // html += '<tr>';
            // html += '<td>'+Object.keys(data[count])[1]+'</td>'; 
            // html += '<td>'+Object.values(data[count])[1]+'</td>'; 

            // html += '</tr>';
        }
        html += '</table>';      
        
        $('.modal-content .modal-body').empty().append(html) 
       
        $('#upcomingevents').modal('show'); 
                        
          },
      })
    }
  </script> 

{%endblock%}









